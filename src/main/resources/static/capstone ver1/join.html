<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- The above 4 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <!-- Title -->
    <title>GET-TOO 회원가입</title>

    <!-- Favicon -->
    <link rel="icon" href="../img/core-img/favicon.ico">

    <!-- Stylesheet -->
    <link rel="stylesheet" href="style_join.css">
    <script src="js/jquery/jquery-2.2.4.min.js"></script>

</head>

<body>
    <!-- Preloader -->
    <div class="preloader d-flex align-items-center justify-content-center">
        <div class="lds-ellipsis">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
    
<!-- login area -->
    <section class="join_form">
      <h1> 회원가입 </h1>
      <form action="/client/join" method="POST">
        <div class="int-area">
            <input type="text" name="id" id="id" autocomplete="off" required  maxlength="20">
            <label for="id"> 아이디 </label>
            <button id="btn">중복 확인</button>
        </div>
        <div class="int-area">
          <input type="password" name="password" class="password" autocomplete="off" required minlength="7" maxlength="20">
          <label for="pwd"> 비밀번호 (7자 이상)</label>
        </div>
         <div class="int-area">
          <input type="password" name="pwCheck" class="pw" autocomplete="off" required  minlength="7" maxlength="20">
          <label for="pwCheck"> 비밀번호 확인 (7자 이상)</label>
        </div>
        <div class="int-area">
            <input type="text" name="name" id="name" autocomplete="off" required maxlength="10">
            <label for="name"> 이름 </label>
        </div>
         <div class="int-area">
          <input type="text" name="age" class="age" autocomplete="off" required>
          <label for="email"> 이메일 </label>
        </div>
        <div class="int-area">
          <input name="studentNumber" type="text" class="studentNumber" autocomplete="off" required maxlength="13">
          <label for="text"> 휴대폰 번호 ('-'포함 13자) </label>
        </div>
        <div class="btn-area">
            <button id="btn" type="submit"> 회원가입 </button>
        </div>
      </form>
    </section>

    <script>
        let id = $('#id');
        let pw = $('#pw');
        let btn = $('#btn');

        $(btn).on('click', function() {
            if($(id).val() == "") {
                $(id).next('label').addClass('warning');
                setTimeout(function() {
                    $('label').removeClass('warning');
                },1500)
            }
            else if($(pw).val() == "") {
                $(pw).next('label').addClass('warning');
                setTimeout(function() {
                    $('label').removeClass('warning');
                },1500)
            }
        });

        $(function(){
    // 회원 가입 처리
    $('#join-submit').click(function(e){
        e.preventDefault();
        if($("#id").val() ==''){
            alert('아이디를 입력하세요');
            $("#id").focus();
            return false;
        }

        var email = $('#email').val();
        if(email == ''){
            alert('이메일을 입력하세요');
            $("#email").focus();
            return false;
        } else {
            var emailRegex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
            if (!emailRegex.test(email)) {
                alert('이메일 주소가 유효하지 않습니다. ex)abc@gmail.com');
                $("#email").focus();
                return false;
            }
        }

        if($("#pw").val() ==''){
            alert('비밀번호를 입력하세요');
            $("#pw").focus();
            return false;
        }

        if($("#pwCheck").val() ==''){
            alert('비밀번호를 다시 한번 더 입력하세요');
            $("#pwCheck").focus();
            return false;
        }
        
        if($("#pw").val()!== $("#pwCheck").val()){
            alert('비밀번호를 둘다 동일하게 입력하세요');
            return false;
        }

        if($("#cellphoneNo").val() ==''){
            alert('휴대폰 번호를 입력하세요');
            $("#cellphoneNo").focus();
            return false;
        }
        
        
        $.ajax({
            url: 'register.php',
            type: 'POST',
            data: {
                name:$("#name").val(),
                userID:$('#id').val(),
                email:$('#email').val(),
                password:$('#pw').val(),
                mobileNO:$("#cellphoneNo").val()
            },
            dataType: "json",
            success: function (response) {
                if(response.result == 1){
                    alert('가입 완료');
                    location.replace('../index.php'); // 화면 갱신
                } else if(response.result == 0){
                    alert('이미 가입된 아이디입니다');
                } else if(response.result == -2){
                    alert('입력된 값이 없습니다');
                } else {
                    alert('등록중에 에러가 발생했습니다');
                }
            },
            error: function(jqXHR, textStatus, errorThrown){
                alert("arjax error : " + textStatus + "\n" + errorThrown);
            }
        });        
        
    });

});
    </script>

</body>

</html>